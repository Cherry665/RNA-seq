# 使用clusterProfiler进行富集分析
前面两步之前已经执行过

```R
# 接续着上面的结果
ensembl_gene_id <- row.names(diff_gene)

# 得到symbol
rat_symbols <-getBM(attributes=c("ensembl_gene_id","external_gene_name","entrezgene_id", "description"), filters = 'ensembl_gene_id', values = ensembl_gene_id, mart = mart)

# 从 rat_symbols 数据框中提取 ensembl_gene_id 列，并将其保存为diff_gene_ensembl_id
diff_gene_ensembl_id <- rat_symbols$ensembl_gene_id
```

# GO分析
循环3次，分别处理MF、BP、CC（分子功能（MF）、生物过程（BP）、细胞组成（CC））

```R
# 先加载包
library(clusterProfiler)
library(org.Rn.eg.db)

# 再进行分析（当gene为entrezgene_id时用'ENTREZID'，当gene为ensembl_gene_id时用'ENSEMBL'），可生成可视化图
# (想看到可视化图，需用print（）包围包含dotplot的一行所有内容)单独执行一个不需要，会直接出现
for(i in c("MF", "BP", "CC")){
    ego <- enrichGO(gene       = rat_symbols$entrezgene_id,
                    OrgDb      = org.Rn.eg.db,
                    keyType    = 'ENTREZID',
                    ont        = i,
                    pAdjustMethod = "BH",
                    pvalueCutoff = 0.01,
                    qvalueCutoff = 0.05)
    dotplot(ego, showCategory = 30, title = paste("The GO ", i, " enrichment analysis", sep = ""))
}
```

# KEGG分析

```R
kk <- enrichKEGG(gene = rat_symbols$entrezgene_id 
                 organism ='rno',
                 pvalueCutoff = 0.05,
                 qvalueCutoff = 0.05,
                 minGSSize = 10,
                 use_internal_data = FALSE)
```